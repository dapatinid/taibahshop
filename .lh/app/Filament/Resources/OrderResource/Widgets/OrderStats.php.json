{
    "sourceFile": "app/Filament/Resources/OrderResource/Widgets/OrderStats.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1732271126318,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1732271211751,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,9 +14,9 @@\n     protected function getStats(): array\n     {\n         // $unpaid = Number::abbreviate(Order::query()->where('branch_id', Auth::user()->branch_id)->where('is_paid', 0)->where('status', '!=', 'canceled')->sum('grand_total'), precision: 2);\n         $unpaid = Number::format(Order::query()->where('branch_id', Auth::user()->branch_id)\n-            ->where('is_paid', 0)->where('status', '!=', 'canceled')\n+        ->where('is_paid', 0)->where('total_cashback', '<=','0')->where('status', '!=', 'canceled')\n             ->sum('grand_total'), locale: 'de');\n         $unpaid = \"Rp\" . $unpaid;\n \n         // $paid = Number::abbreviate(Order::query()->where('branch_id', Auth::user()->branch_id)->where('is_paid', 1)->where('status', '!=', 'canceled')->where('created_at', '>=', Carbon::today())->sum('grand_total'), precision: 2);\n"
                },
                {
                    "date": 1732271227494,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,9 +15,9 @@\n     {\n         // $unpaid = Number::abbreviate(Order::query()->where('branch_id', Auth::user()->branch_id)->where('is_paid', 0)->where('status', '!=', 'canceled')->sum('grand_total'), precision: 2);\n         $unpaid = Number::format(Order::query()->where('branch_id', Auth::user()->branch_id)\n             ->where('is_paid', 0)->where('total_cashback', '<=', '0')->where('status', '!=', 'canceled')\n-            ->sum('grand_total'), locale: 'de');\n+            ->sum('total_cashback'), locale: 'de');\n         $unpaid = \"Rp\" . $unpaid;\n \n         // $paid = Number::abbreviate(Order::query()->where('branch_id', Auth::user()->branch_id)->where('is_paid', 1)->where('status', '!=', 'canceled')->where('created_at', '>=', Carbon::today())->sum('grand_total'), precision: 2);\n         $paid = Number::format(Order::query()->where('branch_id', Auth::user()->branch_id)\n"
                },
                {
                    "date": 1732601262221,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,9 +14,9 @@\n     protected function getStats(): array\n     {\n         // $unpaid = Number::abbreviate(Order::query()->where('branch_id', Auth::user()->branch_id)->where('is_paid', 0)->where('status', '!=', 'canceled')->sum('grand_total'), precision: 2);\n         $unpaid = Number::format(Order::query()->where('branch_id', Auth::user()->branch_id)\n-            ->where('is_paid', 0)->where('total_cashback', '<=', '0')->where('status', '!=', 'canceled')\n+            ->where('is_paid', 0)->where('total_cashback', '<', '0')->where('status', '!=', 'canceled')\n             ->sum('total_cashback'), locale: 'de');\n         $unpaid = \"Rp\" . $unpaid;\n \n         // $paid = Number::abbreviate(Order::query()->where('branch_id', Auth::user()->branch_id)->where('is_paid', 1)->where('status', '!=', 'canceled')->where('created_at', '>=', Carbon::today())->sum('grand_total'), precision: 2);\n"
                }
            ],
            "date": 1732271126318,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Filament\\Resources\\OrderResource\\Widgets;\n\nuse App\\Models\\Order;\nuse Carbon\\Carbon;\nuse Filament\\Widgets\\StatsOverviewWidget as BaseWidget;\nuse Filament\\Widgets\\StatsOverviewWidget\\Stat;\nuse Illuminate\\Support\\Facades\\Auth;\nuse Illuminate\\Support\\Number;\n\nclass OrderStats extends BaseWidget\n{\n    protected function getStats(): array\n    {\n        // $unpaid = Number::abbreviate(Order::query()->where('branch_id', Auth::user()->branch_id)->where('is_paid', 0)->where('status', '!=', 'canceled')->sum('grand_total'), precision: 2);\n        $unpaid = Number::format(Order::query()->where('branch_id', Auth::user()->branch_id)\n            ->where('is_paid', 0)->where('status', '!=', 'canceled')\n            ->sum('grand_total'), locale: 'de');\n        $unpaid = \"Rp\" . $unpaid;\n\n        // $paid = Number::abbreviate(Order::query()->where('branch_id', Auth::user()->branch_id)->where('is_paid', 1)->where('status', '!=', 'canceled')->where('created_at', '>=', Carbon::today())->sum('grand_total'), precision: 2);\n        $paid = Number::format(Order::query()->where('branch_id', Auth::user()->branch_id)\n            ->where('is_paid', 1)->where('status', '!=', 'canceled')->where('created_at', '>=', Carbon::today())\n            ->sum('grand_total'), locale: 'de');\n        $paid = \"Rp\" . $paid;\n\n        return [\n            Stat::make('New Order', Order::query()->where('branch_id', Auth::user()->branch_id)->where('status', 'new')->count()),\n            Stat::make('Order Processing', Order::query()->where('branch_id', Auth::user()->branch_id)->where('status', 'processing')->count()),\n            Stat::make('Order Shipped', Order::query()->where('branch_id', Auth::user()->branch_id)->where('status', 'shipped')->count()),\n\n            Stat::make('Payment Pending (All)', Order::query()->where('branch_id', Auth::user()->branch_id)->where('is_paid', 0)->count())\n                ->icon('heroicon-m-bell'),\n            Stat::make('Total Pending (All)', $unpaid)\n                ->description('3% decrease')\n                ->descriptionIcon('heroicon-m-arrow-trending-down')\n                ->color('success')\n                ->chart([10, 3, 15, 4, 17, 7, 2]),\n            Stat::make('Total Paid Today', $paid)\n                ->description('15% increase')\n                ->descriptionIcon('heroicon-m-arrow-trending-up')\n                ->color('info')\n                ->chart([7, 2, 10, 3, 15, 4, 17]),\n        ];\n    }\n}\n"
        }
    ]
}